<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Wellness Tracker - Build Better Habits</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary: #4f46e5;
            --primary-light: #818cf8;
            --secondary: #10b981;
            --background: #f9fafb;
            --surface: #ffffff;
            --text: #1f2937;
            --text-light: #6b7280;
            --border: #e5e7eb;
            --success: #10b981;
            --warning: #f59e0b;
            --danger: #ef4444;
            --calories: #ef4444;
            --protein: #3b82f6;
            --carbs: #f97316;
            --fat: #fbbf24;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background-color: var(--background);
            color: var(--text);
            line-height: 1.6;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px 0;
            border-bottom: 1px solid var(--border);
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--primary);
        }

        .user-profile {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .user-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background-color: var(--primary-light);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
        }

        .dashboard {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-top: 30px;
        }

        .card {
            background-color: var(--surface);
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .card-title {
            font-size: 1.25rem;
            font-weight: 600;
        }

        .habit-list {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .habit-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 15px;
            background-color: var(--background);
            border-radius: 8px;
            transition: all 0.3s ease;
        }

        .habit-item:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }

        .habit-info {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .habit-icon {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
        }

        .habit-icon.water { background-color: #3b82f6; }
        .habit-icon.reading { background-color: #8b5cf6; }
        .habit-icon.walking { background-color: #ec4899; }
        .habit-icon.meditation { background-color: #f97316; }
        .habit-icon.journaling { background-color: #10b981; }

        .habit-details h3 {
            font-size: 1rem;
            margin-bottom: 2px;
        }

        .habit-details p {
            font-size: 0.85rem;
            color: var(--text-light);
        }

        .habit-checkbox {
            width: 24px;
            height: 24px;
            accent-color: var(--secondary);
            cursor: pointer;
        }

        .calendar {
            margin-top: 30px;
        }

        .calendar-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .calendar-nav {
            display: flex;
            gap: 10px;
        }

        .calendar-nav button {
            background-color: var(--surface);
            border: 1px solid var(--border);
            border-radius: 6px;
            padding: 8px 12px;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .calendar-nav button:hover {
            background-color: var(--background);
        }

        .calendar-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 10px;
        }

        .calendar-day {
            aspect-ratio: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s ease;
            position: relative;
        }

        .calendar-day:hover {
            background-color: var(--background);
        }

        .calendar-day.other-month {
            color: var(--text-light);
        }

        .calendar-day.today {
            border: 2px solid var(--primary);
        }

        .calendar-day .day-number {
            font-weight: 600;
            margin-bottom: 4px;
        }

        .calendar-day .day-progress {
            font-size: 0.75rem;
            color: var(--text-light);
        }

        .calendar-day.completed {
            background-color: rgba(16, 185, 129, 0.15);
        }

        .calendar-day.partial {
            background-color: rgba(245, 158, 11, 0.15);
        }

        .calendar-day.missed {
            background-color: rgba(239, 68, 68, 0.15);
        }

        .progress-section {
            margin-top: 30px;
        }

        .progress-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .stat-card {
            background-color: var(--surface);
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
            text-align: center;
        }

        .stat-value {
            font-size: 2rem;
            font-weight: 700;
            margin: 10px 0;
        }

        .stat-label {
            color: var(--text-light);
            font-size: 0.9rem;
        }

        .motivation-card {
            background: linear-gradient(135deg, var(--primary), var(--primary-light));
            color: white;
            border-radius: 12px;
            padding: 20px;
            margin-top: 30px;
            text-align: center;
        }

        .motivation-card h3 {
            margin-bottom: 10px;
        }

        .motivation-card p {
            font-style: italic;
            margin-bottom: 15px;
        }

        .motivation-card button {
            background-color: white;
            color: var(--primary);
            border: none;
            border-radius: 6px;
            padding: 8px 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .motivation-card button:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }

        .add-habit-btn {
            background-color: var(--primary);
            color: white;
            border: none;
            border-radius: 8px;
            padding: 10px 15px;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: all 0.2s ease;
        }

        .add-habit-btn:hover {
            background-color: var(--primary-light);
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            align-items: center;
            justify-content: center;
            z-index: 1000;
        }

        .modal-content {
            background-color: var(--surface);
            border-radius: 12px;
            padding: 30px;
            width: 90%;
            max-width: 500px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .modal-title {
            font-size: 1.5rem;
            font-weight: 700;
        }

        .close-btn {
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: var(--text-light);
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
        }

        .form-group input,
        .form-group select {
            width: 100%;
            padding: 12px;
            border: 1px solid var(--border);
            border-radius: 6px;
            font-size: 1rem;
        }

        .form-actions {
            display: flex;
            justify-content: flex-end;
            gap: 10px;
        }

        .btn {
            padding: 10px 20px;
            border-radius: 6px;
            font-weight: 600;
            cursor: pointer;
            border: none;
            transition: all 0.2s ease;
        }

        .btn-primary {
            background-color: var(--primary);
            color: white;
        }

        .btn-primary:hover {
            background-color: var(--primary-light);
        }

        .btn-secondary {
            background-color: var(--background);
            color: var(--text);
            border: 1px solid var(--border);
        }

        .btn-secondary:hover {
            background-color: var(--border);
        }

        .notification {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background-color: var(--surface);
            border-radius: 8px;
            padding: 15px 20px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            display: flex;
            align-items: center;
            gap: 15px;
            transform: translateY(100px);
            opacity: 0;
            transition: all 0.3s ease;
            z-index: 1000;
        }

        .notification.show {
            transform: translateY(0);
            opacity: 1;
        }

        .notification-icon {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
        }

        .notification-icon.success {
            background-color: var(--success);
        }

        .notification-icon.motivation {
            background-color: var(--primary);
        }

        .notification-icon.calories {
            background-color: var(--calories);
        }

        /* Calories Tracker Styles */
        .calories-tracker {
            margin-top: 30px;
        }

        .upload-area {
            border: 2px dashed var(--border);
            border-radius: 12px;
            padding: 40px;
            text-align: center;
            transition: all 0.3s ease;
            cursor: pointer;
            background-color: var(--background);
        }

        .upload-area:hover {
            border-color: var(--primary);
            background-color: rgba(79, 70, 229, 0.05);
        }

        .upload-area.dragover {
            border-color: var(--primary);
            background-color: rgba(79, 70, 229, 0.1);
        }

        .upload-icon {
            font-size: 3rem;
            color: var(--primary-light);
            margin-bottom: 15px;
        }

        .upload-text {
            font-size: 1.1rem;
            margin-bottom: 10px;
        }

        .upload-subtext {
            color: var(--text-light);
            font-size: 0.9rem;
        }

        .file-input {
            display: none;
        }

        .image-preview {
            margin-top: 20px;
            text-align: center;
            display: none;
        }

        .preview-image {
            max-width: 100%;
            max-height: 300px;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }

        .analyze-btn {
            background-color: var(--primary);
            color: white;
            border: none;
            border-radius: 8px;
            padding: 12px 24px;
            font-weight: 600;
            cursor: pointer;
            margin-top: 15px;
            transition: all 0.2s ease;
        }

        .analyze-btn:hover {
            background-color: var(--primary-light);
        }

        .analyze-btn:disabled {
            background-color: var(--text-light);
            cursor: not-allowed;
        }

        .nutrition-results {
            margin-top: 30px;
            display: none;
        }

        .food-name {
            font-size: 1.5rem;
            font-weight: 700;
            margin-bottom: 20px;
            text-align: center;
        }

        .macros-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }

        .macro-card {
            background-color: var(--background);
            border-radius: 8px;
            padding: 15px;
            text-align: center;
        }

        .macro-icon {
            font-size: 2rem;
            margin-bottom: 10px;
        }

        .macro-icon.calories { color: var(--calories); }
        .macro-icon.protein { color: var(--protein); }
        .macro-icon.carbs { color: var(--carbs); }
        .macro-icon.fat { color: var(--fat); }

        .macro-value {
            font-size: 1.5rem;
            font-weight: 700;
            margin-bottom: 5px;
        }

        .macro-label {
            color: var(--text-light);
            font-size: 0.9rem;
        }

        .nutrition-details {
            background-color: var(--background);
            border-radius: 8px;
            padding: 20px;
            margin-top: 20px;
        }

        .nutrition-details h4 {
            margin-bottom: 15px;
            font-size: 1.1rem;
        }

        .nutrition-list {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 10px;
        }

        .nutrition-item {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            border-bottom: 1px solid var(--border);
        }

        .nutrition-item:last-child {
            border-bottom: none;
        }

        .nutrition-name {
            font-weight: 500;
        }

        .nutrition-value {
            color: var(--text-light);
        }

        .add-to-log-btn {
            background-color: var(--secondary);
            color: white;
            border: none;
            border-radius: 8px;
            padding: 12px 24px;
            font-weight: 600;
            cursor: pointer;
            width: 100%;
            margin-top: 20px;
            transition: all 0.2s ease;
        }

        .add-to-log-btn:hover {
            background-color: #059669;
        }

        .food-log {
            margin-top: 30px;
        }

        .food-log-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .food-log-list {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .food-log-item {
            display: flex;
            align-items: items-center;
            justify-content: space-between;
            padding: 15px;
            background-color: var(--background);
            border-radius: 8px;
        }

        .food-log-info {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .food-log-image {
            width: 60px;
            height: 60px;
            border-radius: 8px;
            object-fit: cover;
        }

        .food-log-details h4 {
            margin-bottom: 5px;
        }

        .food-log-details p {
            color: var(--text-light);
            font-size: 0.9rem;
        }

        .food-log-macros {
            display: flex;
            gap: 15px;
        }

        .food-log-macro {
            text-align: center;
        }

        .food-log-macro-value {
            font-weight: 700;
        }

        .food-log-macro-label {
            font-size: 0.8rem;
            color: var(--text-light);
        }

        .delete-btn {
            background: none;
            border: none;
            color: var(--danger);
            cursor: pointer;
            font-size: 1.2rem;
            padding: 5px;
            transition: all 0.2s ease;
        }

        .delete-btn:hover {
            transform: scale(1.2);
        }

        /* Loading spinner */
        .spinner {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top-color: white;
            animation: spin 1s ease-in-out infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .loading-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 40px;
        }

        .loading-text {
            margin-top: 15px;
            color: var(--text-light);
        }

        /* API Key Modal */
        .api-key-container {
            margin-top: 20px;
        }

        .api-key-input {
            width: 100%;
            padding: 12px;
            border: 1px solid var(--border);
            border-radius: 6px;
            font-size: 1rem;
            margin-bottom: 15px;
        }

        .api-info {
            background-color: rgba(79, 70, 229, 0.1);
            border-left: 4px solid var(--primary);
            padding: 15px;
            border-radius: 6px;
            margin-bottom: 20px;
            font-size: 0.9rem;
        }

        .api-info h4 {
            margin-bottom: 10px;
            color: var(--primary);
        }

        .api-info ul {
            padding-left: 20px;
        }

        .api-info li {
            margin-bottom: 5px;
        }

        @media (max-width: 768px) {
            .dashboard {
                grid-template-columns: 1fr;
            }
            
            .progress-stats {
                grid-template-columns: 1fr;
            }
            
            .calendar-grid {
                gap: 5px;
            }
            
            .macros-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .nutrition-list {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <div class="logo">
                <i class="fas fa-heartbeat"></i>
                <span>Wellness Tracker</span>
            </div>
            <div class="user-profile">
                <span>Welcome, User!</span>
                <div class="user-avatar">U</div>
            </div>
        </header>

        <div class="dashboard">
            <div class="card">
                <div class="card-header">
                    <h2 class="card-title">Daily Habits</h2>
                    <button class="add-habit-btn" id="addHabitBtn">
                        <i class="fas fa-plus"></i> Add Habit
                    </button>
                </div>
                <div class="habit-list" id="habitList">
                    <!-- Habits will be dynamically loaded here -->
                </div>
            </div>

            <div class="card">
                <div class="card-header">
                    <h2 class="card-title">Today's Progress</h2>
                </div>
                <div class="progress-stats">
                    <div class="stat-card">
                        <div class="stat-value" id="completedCount">0</div>
                        <div class="stat-label">Completed</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="totalCount">0</div>
                        <div class="stat-label">Total Habits</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="currentStreak">0</div>
                        <div class="stat-label">Current Streak</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Calories Tracker Section -->
        <div class="calories-tracker">
            <div class="card">
                <div class="card-header">
                    <h2 class="card-title">AI Calories Tracker</h2>
                    <span style="color: var(--text-light); font-size: 0.9rem;">Powered by Google Gemini</span>
                </div>
                
                <div class="api-info">
                    <h4>How to use AI Analysis</h4>
                    <ul>
                        <li>Upload a photo of your food</li>
                        <li>Click "Analyze with Gemini AI" to get nutritional information</li>
                        <li>View calories, protein, carbs, and fat breakdown</li>
                        <li>Add the food to your daily log</li>
                    </ul>
                </div>
                
                <div class="upload-area" id="uploadArea">
                    <div class="upload-icon">
                        <i class="fas fa-camera"></i>
                    </div>
                    <div class="upload-text">Click or drag to upload food image</div>
                    <div class="upload-subtext">Supports JPG, PNG up to 10MB</div>
                    <input type="file" class="file-input" id="fileInput" accept="image/*" capture="camera">
                </div>
                
                <div class="image-preview" id="imagePreview">
                    <img src="" alt="Food preview" class="preview-image" id="previewImage">
                    <br>
                    <button class="analyze-btn" id="analyzeBtn">
                        <span id="analyzeBtnText">Analyze with Gemini AI</span>
                        <span id="analyzeBtnSpinner" class="spinner" style="display: none;"></span>
                    </button>
                </div>
                
                <div class="loading-container" id="loadingContainer" style="display: none;">
                    <div class="spinner"></div>
                    <div class="loading-text">Analyzing your food with Gemini AI...</div>
                </div>
                
                <div class="nutrition-results" id="nutritionResults">
                    <div class="food-name" id="foodName">Food Analysis</div>
                    
                    <div class="macros-grid">
                        <div class="macro-card">
                            <div class="macro-icon calories">
                                <i class="fas fa-fire"></i>
                            </div>
                            <div class="macro-value" id="caloriesValue">0</div>
                            <div class="macro-label">Calories</div>
                        </div>
                        
                        <div class="macro-card">
                            <div class="macro-icon protein">
                                <i class="fas fa-drumstick-bite"></i>
                            </div>
                            <div class="macro-value" id="proteinValue">0g</div>
                            <div class="macro-label">Protein</div>
                        </div>
                        
                        <div class="macro-card">
                            <div class="macro-icon carbs">
                                <i class="fas fa-bread-slice"></i>
                            </div>
                            <div class="macro-value" id="carbsValue">0g</div>
                            <div class="macro-label">Carbs</div>
                        </div>
                        
                        <div class="macro-card">
                            <div class="macro-icon fat">
                                <i class="fas fa-cheese"></i>
                            </div>
                            <div class="macro-value" id="fatValue">0g</div>
                            <div class="macro-label">Fat</div>
                        </div>
                    </div>
                    
                    <div class="nutrition-details">
                        <h4>Detailed Nutrition</h4>
                        <div class="nutrition-list" id="nutritionList">
                            <!-- Nutrition details will be populated here -->
                        </div>
                    </div>
                    
                    <button class="add-to-log-btn" id="addToLogBtn">Add to Food Log</button>
                </div>
            </div>
        </div>

        <!-- Food Log Section -->
        <div class="food-log">
            <div class="card">
                <div class="food-log-header">
                    <h2 class="card-title">Today's Food Log</h2>
                    <div class="stat-value" id="totalCalories">0 cal</div>
                </div>
                <div class="food-log-list" id="foodLogList">
                    <!-- Food log items will be populated here -->
                </div>
            </div>
        </div>

        <div class="calendar">
            <div class="card">
                <div class="calendar-header">
                    <h2 class="card-title" id="currentMonth">June 2023</h2>
                    <div class="calendar-nav">
                        <button id="prevMonth"><i class="fas fa-chevron-left"></i></button>
                        <button id="nextMonth"><i class="fas fa-chevron-right"></i></button>
                    </div>
                </div>
                <div class="calendar-grid" id="calendarGrid">
                    <!-- Calendar will be dynamically generated here -->
                </div>
            </div>
        </div>

        <div class="motivation-card">
            <h3>Daily Motivation</h3>
            <p id="motivationQuote">"Success is the sum of small efforts repeated day in and day out."</p>
            <button id="newQuoteBtn">New Quote</button>
        </div>
    </div>

    <!-- Add Habit Modal -->
    <div class="modal" id="addHabitModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">Add New Habit</h3>
                <button class="close-btn" id="closeModal">&times;</button>
            </div>
            <form id="addHabitForm">
                <div class="form-group">
                    <label for="habitName">Habit Name</label>
                    <input type="text" id="habitName" placeholder="e.g., Drink 8 glasses of water" required>
                </div>
                <div class="form-group">
                    <label for="habitIcon">Icon</label>
                    <select id="habitIcon" required>
                        <option value="water">Water</option>
                        <option value="reading">Reading</option>
                        <option value="walking">Walking</option>
                        <option value="meditation">Meditation</option>
                        <option value="journaling">Journaling</option>
                    </select>
                </div>
                <div class="form-actions">
                    <button type="button" class="btn btn-secondary" id="cancelBtn">Cancel</button>
                    <button type="submit" class="btn btn-primary">Add Habit</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Notification -->
    <div class="notification" id="notification">
        <div class="notification-icon success" id="notificationIcon">
            <i class="fas fa-check"></i>
        </div>
        <div>
            <div id="notificationTitle">Notification</div>
            <div id="notificationMessage">Message</div>
        </div>
    </div>

    <script>
        // Sample data
        const motivationQuotes = [
            "Success is the sum of small efforts repeated day in and day out.",
            "The secret of getting ahead is getting started.",
            "Don't watch the clock; do what it does. Keep going.",
            "The journey of a thousand miles begins with one step.",
            "You don't have to be great to start, but you have to start to be great.",
            "Every day is a new opportunity to build the life you want.",
            "Small daily improvements are the key to staggering long-term results.",
            "Consistency is what transforms average into excellence."
        ];

        // Initialize app
        document.addEventListener('DOMContentLoaded', function() {
            initializeApp();
            loadHabits();
            renderCalendar();
            updateStats();
            showRandomQuote();
            requestNotificationPermission();
            setDailyReminder();
            initializeCaloriesTracker();
            loadFoodLog();
        });

        // Initialize app with default habits if none exist
        function initializeApp() {
            if (!localStorage.getItem('habits')) {
                const defaultHabits = [
                    { id: 1, name: 'Drink 8 glasses of water', icon: 'water', completed: false },
                    { id: 2, name: 'Read for 20 minutes', icon: 'reading', completed: false },
                    { id: 3, name: 'Walk 10,000 steps', icon: 'walking', completed: false },
                    { id: 4, name: 'Meditate for 10 minutes', icon: 'meditation', completed: false },
                    { id: 5, name: 'Journal before bed', icon: 'journaling', completed: false }
                ];
                localStorage.setItem('habits', JSON.stringify(defaultHabits));
            }

            if (!localStorage.getItem('habitLogs')) {
                localStorage.setItem('habitLogs', JSON.stringify({}));
            }

            if (!localStorage.getItem('currentStreak')) {
                localStorage.setItem('currentStreak', 0);
            }

            if (!localStorage.getItem('foodLog')) {
                localStorage.setItem('foodLog', JSON.stringify([]));
            }
        }

        // Load habits from localStorage
        function loadHabits() {
            const habitList = document.getElementById('habitList');
            const habits = JSON.parse(localStorage.getItem('habits')) || [];
            
            habitList.innerHTML = '';
            
            habits.forEach(habit => {
                const habitItem = document.createElement('div');
                habitItem.className = 'habit-item';
                habitItem.innerHTML = `
                    <div class="habit-info">
                        <div class="habit-icon ${habit.icon}">
                            <i class="fas fa-${getIconClass(habit.icon)}"></i>
                        </div>
                        <div class="habit-details">
                            <h3>${habit.name}</h3>
                            <p>Daily habit</p>
                        </div>
                    </div>
                    <input type="checkbox" class="habit-checkbox" id="habit-${habit.id}" ${habit.completed ? 'checked' : ''}>
                `;
                
                habitList.appendChild(habitItem);
                
                // Add event listener to checkbox
                const checkbox = habitItem.querySelector(`#habit-${habit.id}`);
                checkbox.addEventListener('change', function() {
                    toggleHabitCompletion(habit.id, this.checked);
                });
            });
        }

        // Get icon class based on habit icon
        function getIconClass(icon) {
            const iconMap = {
                'water': 'tint',
                'reading': 'book',
                'walking': 'walking',
                'meditation': 'spa',
                'journaling': 'pen'
            };
            return iconMap[icon] || 'check';
        }

        // Toggle habit completion
        function toggleHabitCompletion(habitId, completed) {
            const habits = JSON.parse(localStorage.getItem('habits')) || [];
            const habitIndex = habits.findIndex(h => h.id === habitId);
            
            if (habitIndex !== -1) {
                habits[habitIndex].completed = completed;
                localStorage.setItem('habits', JSON.stringify(habits));
                
                // Update logs
                const today = new Date().toISOString().split('T')[0];
                const logs = JSON.parse(localStorage.getItem('habitLogs')) || {};
                
                if (!logs[today]) {
                    logs[today] = {};
                }
                
                logs[today][habitId] = completed;
                localStorage.setItem('habitLogs', JSON.stringify(logs));
                
                // Update stats
                updateStats();
                
                // Show notification
                showNotification(
                    completed ? 'Habit Completed!' : 'Habit Unchecked',
                    completed ? `Great job completing your habit!` : `No worries, you can complete it later.`,
                    'success'
                );
                
                // Check if all habits are completed
                if (completed) {
                    const allCompleted = habits.every(h => h.completed);
                    if (allCompleted) {
                        showNotification(
                            'All Habits Completed!',
                            'Congratulations! You completed all your habits today!',
                            'success'
                        );
                        // Increase streak
                        const currentStreak = parseInt(localStorage.getItem('currentStreak')) || 0;
                        localStorage.setItem('currentStreak', currentStreak + 1);
                        updateStats();
                    }
                }
            }
        }

        // Update stats
        function updateStats() {
            const habits = JSON.parse(localStorage.getItem('habits')) || [];
            const completedCount = habits.filter(h => h.completed).length;
            const totalCount = habits.length;
            const currentStreak = parseInt(localStorage.getItem('currentStreak')) || 0;
            
            document.getElementById('completedCount').textContent = completedCount;
            document.getElementById('totalCount').textContent = totalCount;
            document.getElementById('currentStreak').textContent = currentStreak;
        }

        // Render calendar
        function renderCalendar() {
            const calendarGrid = document.getElementById('calendarGrid');
            const currentMonthElement = document.getElementById('currentMonth');
            
            const now = new Date();
            const year = now.getFullYear();
            const month = now.getMonth();
            
            // Set current month text
            const monthNames = ["January", "February", "March", "April", "May", "June", 
                "July", "August", "September", "October", "November", "December"];
            currentMonthElement.textContent = `${monthNames[month]} ${year}`;
            
            // Clear calendar
            calendarGrid.innerHTML = '';
            
            // Add day headers
            const dayHeaders = ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'];
            dayHeaders.forEach(day => {
                const dayHeader = document.createElement('div');
                dayHeader.textContent = day;
                dayHeader.style.fontWeight = 'bold';
                dayHeader.style.textAlign = 'center';
                calendarGrid.appendChild(dayHeader);
            });
            
            // Get first day of month
            const firstDay = new Date(year, month, 1).getDay();
            
            // Get days in month
            const daysInMonth = new Date(year, month + 1, 0).getDate();
            
            // Get days from previous month
            const daysInPrevMonth = new Date(year, month, 0).getDate();
            
            // Add previous month days
            for (let i = firstDay - 1; i >= 0; i--) {
                const day = daysInPrevMonth - i;
                const dayElement = createDayElement(day, true, new Date(year, month - 1, day));
                calendarGrid.appendChild(dayElement);
            }
            
            // Add current month days
            for (let day = 1; day <= daysInMonth; day++) {
                const date = new Date(year, month, day);
                const isToday = date.toDateString() === now.toDateString();
                const dayElement = createDayElement(day, false, date, isToday);
                calendarGrid.appendChild(dayElement);
            }

            // Add next month days
            const totalCells = calendarGrid.children.length - 7; // Subtract headers
            const remainingCells = 35 - totalCells; // 5 rows * 7 days = 35

            for (let day = 1; day <= remainingCells; day++) {
                const dayElement = createDayElement(day, true, new Date(year, month + 1, day));
                calendarGrid.appendChild(dayElement);
            }
        }

        // Create day element for calendar
        function createDayElement(day, isOtherMonth, date, isToday = false) {
            const dayElement = document.createElement('div');
            dayElement.className = 'calendar-day';

            if (isOtherMonth) {
                dayElement.classList.add('other-month');
            }

            if (isToday) {
                dayElement.classList.add('today');
            }

            // Get progress for this day
            const progress = getDayProgress(date);

            if (progress === 100) {
                dayElement.classList.add('completed');
            } else if (progress > 0) {
                dayElement.classList.add('partial');
            } else if (progress === 0 && !isOtherMonth) {
                dayElement.classList.add('missed');
            }

            dayElement.innerHTML = `
                <div class="day-number">${day}</div>
                <div class="day-progress">${progress}%</div>
            `;

            return dayElement;
        }

        // Get progress for a specific day
        function getDayProgress(date) {
            const dateString = date.toISOString().split('T')[0];
            const logs = JSON.parse(localStorage.getItem('habitLogs')) || {};
            const habits = JSON.parse(localStorage.getItem('habits')) || [];

            if (!logs[dateString]) {
                return 0;
            }

            const completedHabits = Object.values(logs[dateString]).filter(status => status === true).length;
            return Math.round((completedHabits / habits.length) * 100);
        }

        // Show random quote
        function showRandomQuote() {
            const quoteElement = document.getElementById('motivationQuote');
            const randomIndex = Math.floor(Math.random() * motivationQuotes.length);
            quoteElement.textContent = `"${motivationQuotes[randomIndex]}"`;
        }

        // New quote button
        document.getElementById('newQuoteBtn').addEventListener('click', showRandomQuote);

        // Modal functionality
        const addHabitModal = document.getElementById('addHabitModal');
        const addHabitBtn = document.getElementById('addHabitBtn');
        const closeModal = document.getElementById('closeModal');
        const cancelBtn = document.getElementById('cancelBtn');
        const addHabitForm = document.getElementById('addHabitForm');

        addHabitBtn.addEventListener('click', function() {
            addHabitModal.style.display = 'flex';
        });

        closeModal.addEventListener('click', function() {
            addHabitModal.style.display = 'none';
        });

        cancelBtn.addEventListener('click', function() {
            addHabitModal.style.display = 'none';
        });

        // Add habit form submission
        addHabitForm.addEventListener('submit', function(e) {
            e.preventDefault();

            const habitName = document.getElementById('habitName').value;
            const habitIcon = document.getElementById('habitIcon').value;

            const habits = JSON.parse(localStorage.getItem('habits')) || [];
            const newHabit = {
                id: habits.length > 0 ? Math.max(...habits.map(h => h.id)) + 1 : 1,
                name: habitName,
                icon: habitIcon,
                completed: false
            };

            habits.push(newHabit);
            localStorage.setItem('habits', JSON.stringify(habits));

            loadHabits();
            updateStats();

            addHabitModal.style.display = 'none';
            addHabitForm.reset();

            showNotification(
                'Habit Added!',
                `"${habitName}" has been added to your daily habits.`,
                'success'
            );
        });

        // Calendar navigation
        document.getElementById('prevMonth').addEventListener('click', function() {
            // In a real app, this would navigate to previous month
            showNotification(
                'Feature Coming Soon',
                'Month navigation will be available in the next update.',
                'success'
            );
        });

        document.getElementById('nextMonth').addEventListener('click', function() {
            // In a real app, this would navigate to next month
            showNotification(
                'Feature Coming Soon',
                'Month navigation will be available in the next update.',
                'success'
            );
        });

        // Notification system
        function showNotification(title, message, type = 'success') {
            const notification = document.getElementById('notification');
            const notificationTitle = document.getElementById('notificationTitle');
            const notificationMessage = document.getElementById('notificationMessage');
            const notificationIcon = document.getElementById('notificationIcon');

            notificationTitle.textContent = title;
            notificationMessage.textContent = message;

            // Set icon based on type
            if (type === 'success') {
                notificationIcon.className = 'notification-icon success';
                notificationIcon.innerHTML = '<i class="fas fa-check"></i>';
            } else if (type === 'motivation') {
                notificationIcon.className = 'notification-icon motivation';
                notificationIcon.innerHTML = '<i class="fas fa-lightbulb"></i>';
            } else if (type === 'calories') {
                notificationIcon.className = 'notification-icon calories';
                notificationIcon.innerHTML = '<i class="fas fa-fire"></i>';
            }

            notification.classList.add('show');

            setTimeout(() => {
                notification.classList.remove('show');
            }, 3000);
        }

        // Request notification permission
        function requestNotificationPermission() {
            if ('Notification' in window && Notification.permission === 'default') {
                Notification.requestPermission();
            }
        }

        // Set daily reminder
        function setDailyReminder() {
            // In a real app, this would use a backend service to send push notifications
            // For this demo, we'll use browser notifications if permission is granted

            if ('Notification' in window && Notification.permission === 'granted') {
                // Set a reminder for 8 AM every day
                const now = new Date();
                const tomorrow = new Date(now);
                tomorrow.setDate(now.getDate() + 1);
                tomorrow.setHours(8, 0, 0, 0);

                const timeUntilReminder = tomorrow - now;

                setTimeout(() => {
                    new Notification('Wellness Tracker Reminder', {
                        body: "Don't forget to complete your daily habits today!",
                        icon: 'https://cdn-icons-png.flaticon.com/512/484/484167.png'
                    });

                    // Set the reminder to repeat daily
                    setInterval(() => {
                        new Notification('Wellness Tracker Reminder', {
                            body: "Don't forget to complete your daily habits today!",
                            icon: 'https://cdn-icons-png.flaticon.com/512/484/484167.png'
                        });
                    }, 24 * 60 * 60 * 1000); // 24 hours
                }, timeUntilReminder);
            }
        }

        // Show motivational notification at random times
        function showMotivationalNotification() {
            if ('Notification' in window && Notification.permission === 'granted') {
                const randomIndex = Math.floor(Math.random() * motivationQuotes.length);
                new Notification('Daily Motivation', {
                    body: motivationQuotes[randomIndex],
                    icon: 'https://cdn-icons-png.flaticon.com/512/484/484167.png'
                });
            }
        }

        // Show motivational notification at random intervals
        setInterval(() => {
            if (Math.random() > 0.7) { // 30% chance each interval
                showMotivationalNotification();
            }
        }, 60 * 60 * 1000); // Check every hour

        // Calories Tracker Functionality with Gemini AI
        function initializeCaloriesTracker() {
            const uploadArea = document.getElementById('uploadArea');
            const fileInput = document.getElementById('fileInput');
            const imagePreview = document.getElementById('imagePreview');
            const previewImage = document.getElementById('previewImage');
            const analyzeBtn = document.getElementById('analyzeBtn');
            const analyzeBtnText = document.getElementById('analyzeBtnText');
            const analyzeBtnSpinner = document.getElementById('analyzeBtnSpinner');
            const nutritionResults = document.getElementById('nutritionResults');
            const loadingContainer = document.getElementById('loadingContainer');
            const addToLogBtn = document.getElementById('addToLogBtn');

            let currentFoodData = null;

            // Click to upload
            uploadArea.addEventListener('click', function() {
                fileInput.click();
            });

            // Drag and drop functionality
            uploadArea.addEventListener('dragover', function(e) {
                e.preventDefault();
                uploadArea.classList.add('dragover');
            });

            uploadArea.addEventListener('dragleave', function() {
                uploadArea.classList.remove('dragover');
            });

            uploadArea.addEventListener('drop', function(e) {
                e.preventDefault();
                uploadArea.classList.remove('dragover');

                if (e.dataTransfer.files.length) {
                    handleFile(e.dataTransfer.files[0]);
                }
            });

            // File input change
            fileInput.addEventListener('change', function() {
                if (this.files.length) {
                    handleFile(this.files[0]);
                }
            });

            // Handle file selection
            function handleFile(file) {
                if (file.type.startsWith('image/')) {
                    const reader = new FileReader();

                    reader.onload = function(e) {
                        previewImage.src = e.target.result;
                        uploadArea.style.display = 'none';
                        imagePreview.style.display = 'block';
                        nutritionResults.style.display = 'none';
                    };

                    reader.readAsDataURL(file);
                } else {
                    showNotification(
                        'Invalid File',
                        'Please upload an image file.',
                        'calories'
                    );
                }
            }

            // Analyze button
            analyzeBtn.addEventListener('click', async function() {
                // Disable button and show loading
                analyzeBtn.disabled = true;
                analyzeBtnText.style.display = 'none';
                analyzeBtnSpinner.style.display = 'inline-block';
                imagePreview.style.display = 'none';
                loadingContainer.style.display = 'flex';

                try {
                    // Get the image data
                    const imageData = previewImage.src;

                    // Call Gemini API for analysis
                    const nutritionData = await analyzeImageWithGemini(imageData);

                    // Store the analyzed data
                    currentFoodData = nutritionData;

                    // Display results
                    displayNutritionResults(nutritionData);

                    // Show success notification
                    showNotification(
                        'Analysis Complete!',
                        `Gemini AI has analyzed your food and identified it as ${nutritionData.name}.`,
                        'calories'
                    );
                } catch (error) {
                    console.error('Error analyzing image:', error);
                    showNotification(
                        'Analysis Failed',
                        'Sorry, we couldn\'t analyze your food. Please try again.',
                        'calories'
                    );
                } finally {
                    // Reset UI
                    analyzeBtn.disabled = false;
                    analyzeBtnText.style.display = 'inline';
                    analyzeBtnSpinner.style.display = 'none';
                    loadingContainer.style.display = 'none';
                    imagePreview.style.display = 'block';
                }
            });

            // Display nutrition results
            function displayNutritionResults(data) {
                document.getElementById('foodName').textContent = data.name;
                document.getElementById('caloriesValue').textContent = data.calories;
                document.getElementById('proteinValue').textContent = data.protein + 'g';
                document.getElementById('carbsValue').textContent = data.carbs + 'g';
                document.getElementById('fatValue').textContent = data.fat + 'g';

                // Populate nutrition details
                const nutritionList = document.getElementById('nutritionList');
                nutritionList.innerHTML = '';

                for (const [nutrient, value] of Object.entries(data.details)) {
                    const nutritionItem = document.createElement('div');
                    nutritionItem.className = 'nutrition-item';
                    nutritionItem.innerHTML = `
                        <span class="nutrition-name">${nutrient}</span>
                        <span class="nutrition-value">${value}</span>
                    `;
                    nutritionList.appendChild(nutritionItem);
                }

                nutritionResults.style.display = 'block';
            }

            // Add to log button
            addToLogBtn.addEventListener('click', function() {
                if (currentFoodData) {
                    const foodLog = JSON.parse(localStorage.getItem('foodLog')) || [];
                    const today = new Date().toISOString().split('T')[0];

                    const newLogItem = {
                        id: Date.now(),
                        name: currentFoodData.name,
                        calories: currentFoodData.calories,
                        protein: currentFoodData.protein,
                        carbs: currentFoodData.carbs,
                        fat: currentFoodData.fat,
                        image: previewImage.src,
                        date: today
                    };

                    foodLog.push(newLogItem);
                    localStorage.setItem('foodLog', JSON.stringify(foodLog));

                    loadFoodLog();

                    // Reset form
                    uploadArea.style.display = 'block';
                    imagePreview.style.display = 'none';
                    nutritionResults.style.display = 'none';
                    fileInput.value = '';

                    showNotification(
                        'Added to Food Log!',
                        `${currentFoodData.name} has been added to today's food log.`,
                        'calories'
                    );
                }
            });
        }

        // Analyze image with Gemini AI
        async function analyzeImageWithGemini(imageData) {
            const apiKey = "AIzaSyC-8jja6WXg0qK65BwZevOO3TDpS0HnR-A";  // Your Gemini API key
            const base64Data = await fileToBase64(imageData);

            const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash:generateContent?key=${apiKey}`, {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({
                    contents: [{
                        parts: [
                            { text: "Analyze this food image and return JSON with: food_name, calories, protein, carbs, fat (per 100g). Also include additional nutrition details like fiber, sugar, sodium, etc." },
                            { inline_data: { mime_type: "image/jpeg", data: base64Data } }
                        ]
                    }]
                })
            });

            const data = await response.json();
            console.log(data);

            if (data.candidates && data.candidates[0] && data.candidates[0].content && data.candidates[0].content.parts) {
                const textResponse = data.candidates[0].content.parts[0].text;
                // Try to parse JSON from the response
                try {
                    // Extract JSON from the text response (Gemini might wrap it in code blocks)
                    const jsonMatch = textResponse.match(/```json\s*(\{[\s\S]*?\})\s*```/) || textResponse.match(/\{[\s\S]*\}/);
                    const jsonString = jsonMatch ? jsonMatch[1] || jsonMatch[0] : textResponse;
                    const nutritionData = JSON.parse(jsonString);

                    return {
                        name: nutritionData.food_name || "Unknown Food",
                        calories: nutritionData.calories || 0,
                        protein: nutritionData.protein || 0,
                        carbs: nutritionData.carbs || 0,
                        fat: nutritionData.fat || 0,
                        details: nutritionData.details || {}
                    };
                } catch (parseError) {
                    console.error('Error parsing Gemini response:', parseError);
                    throw new Error('Failed to parse nutrition data from AI response');
                }
            } else {
                throw new Error('Invalid response from Gemini API');
            }
        }

        // Helper function to convert image to base64
        function fileToBase64(file) {
            return new Promise((resolve, reject) => {
                if (typeof file === 'string') {
                    // If file is already a data URL, extract base64
                    const base64 = file.split(',')[1];
                    resolve(base64);
                } else {
                    const reader = new FileReader();
                    reader.onload = () => resolve(reader.result.split(',')[1]);
                    reader.onerror = reject;
                    reader.readAsDataURL(file);
                }
            });
        }

        // Load food log
        function loadFoodLog() {
            const foodLogList = document.getElementById('foodLogList');
            const totalCaloriesElement = document.getElementById('totalCalories');
            const foodLog = JSON.parse(localStorage.getItem('foodLog')) || [];
            const today = new Date().toISOString().split('T')[0];

            // Filter today's items
            const todayItems = foodLog.filter(item => item.date === today);

            foodLogList.innerHTML = '';
            let totalCalories = 0;

            if (todayItems.length === 0) {
                foodLogList.innerHTML = '<p style="text-align: center; color: var(--text-light);">No food logged today</p>';
            } else {
                todayItems.forEach(item => {
                    totalCalories += item.calories;

                    const logItem = document.createElement('div');
                    logItem.className = 'food-log-item';
                    logItem.innerHTML = `
                        <div class="food-log-info">
                            <img src="${item.image}" alt="${item.name}" class="food-log-image">
                            <div class="food-log-details">
                                <h4>${item.name}</h4>
                                <p>Analyzed with Gemini AI</p>
                            </div>
                        </div>
                        <div class="food-log-macros">
                            <div class="food-log-macro">
                                <div class="food-log-macro-value" style="color: var(--calories)">${item.calories}</div>
                                <div class="food-log-macro-label">cal</div>
                            </div>
                            <div class="food-log-macro">
                                <div class="food-log-macro-value" style="color: var(--protein)">${item.protein}g</div>
                                <div class="food-log-macro-label">protein</div>
                            </div>
                            <div class="food-log-macro">
                                <div class="food-log-macro-value" style="color: var(--carbs)">${item.carbs}g</div>
                                <div class="food-log-macro-label">carbs</div>
                            </div>
                            <div class="food-log-macro">
                                <div class="food-log-macro-value" style="color: var(--fat)">${item.fat}g</div>
                                <div class="food-log-macro-label">fat</div>
                            </div>
                        </div>
                        <button class="delete-btn" data-id="${item.id}">
                            <i class="fas fa-trash"></i>
                        </button>
                    `;

                    foodLogList.appendChild(logItem);

                    // Add delete functionality
                    const deleteBtn = logItem.querySelector('.delete-btn');
                    deleteBtn.addEventListener('click', function() {
                        deleteFoodLogItem(item.id);
                    });
                });
            }

            totalCaloriesElement.textContent = totalCalories + ' cal';
        }

        // Delete food log item
        function deleteFoodLogItem(id) {
            const foodLog = JSON.parse(localStorage.getItem('foodLog')) || [];
            const updatedLog = foodLog.filter(item => item.id !== id);
            localStorage.setItem('foodLog', JSON.stringify(updatedLog));
            loadFoodLog();

            showNotification(
                'Item Deleted',
                'Food item has been removed from your log.',
                'calories'
            );
        }
    </script>
</body>
</html>
